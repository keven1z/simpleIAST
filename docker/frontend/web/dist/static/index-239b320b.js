import{i as G,H as W,_ as H}from"./index-7d92c181.js";import{G as L,H as J,I as U,w as Y}from"./element-25094948.js";import{a as K}from"./index-b8d5ef49.js";import{r as Q}from"./index-617a4af0.js";import{g as X,r as Z,a as tt,b as et}from"./index-3e1c7ec4.js";import{g as at}from"./level-407f4ac4.js";import{g as ot}from"./state-8799bcff.js";import{r as u,p as st,ai as c,q as D,t as k,v as a,U as t,O as e,u as i,S as h,T as b,F as P,a8 as V,I as nt}from"./vue-8cd83afb.js";import"./vxe-49b9e5de.js";const O=u(),lt=u(),E=u(),rt=u(),R=u(),ct=()=>new Promise((_,r)=>{Q().then(o=>{O.value=o.data}).catch(o=>{O.value=0,r(o)})}),it=()=>new Promise((_,r)=>{X().then(o=>{const s=o.data||[],l=[];let y=0;Array.isArray(s)&&s.forEach(p=>{const m=Number(p.level),f=Number(p.count);y+=f,l.push({name:at(m),value:f})}),R.value=y,rt.value=l}).catch(o=>{r(o)})}),dt=()=>new Promise((_,r)=>{K.getAgentStatusCount().then(o=>{const s=o.data,l=[],y=JSON.stringify(s);let p=0;const m=JSON.parse(y);for(const f in m)if(Object.prototype.hasOwnProperty.call(m,f)){const x=m[f];p+=Number(x),l.push({name:ot(Number(f)),value:x})}E.value=p,lt.value=l}).catch(o=>{r(o)})}),ut=(_,r)=>{const o=r.map(s=>parseInt(s)||0);return{backgroundColor:"transparent",grid:{left:"3%",right:"4%",top:"15%",bottom:"10%",containLabel:!0},tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.95)",borderRadius:12,padding:12,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",textStyle:{color:"#333",fontSize:14},borderColor:"#e0e0e0",borderWidth:1,axisPointer:{type:"cross",lineStyle:{color:"#409EFF",width:2},shadow:{color:"rgba(64, 158, 255, 0.1)",blur:10}},formatter:function(s){let l=`${s[0].axisValue}<br/>`;return l+=`<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${s[0].color};"></span>`,l+=`${s[0].seriesName}: <strong>${s[0].value}</strong> 个`,l}},xAxis:[{type:"category",boundaryGap:!1,axisLine:{show:!0,lineStyle:{color:"#e0e0e0"}},axisLabel:{color:"#606266",fontSize:12,margin:15},splitLine:{show:!1},axisTick:{show:!1},data:_}],yAxis:[{type:"value",name:"漏洞数量",nameTextStyle:{color:"#606266",fontSize:12,padding:[0,0,0,10]},splitLine:{show:!0,lineStyle:{color:"#f0f0f0",type:"dashed"}},axisLine:{show:!1},axisLabel:{show:!0,margin:15,textStyle:{color:"#606266",fontSize:12}},axisTick:{show:!1},minInterval:1,splitNumber:5}],series:[{name:"新增漏洞",type:"line",smooth:!0,stack:"总量",symbol:"circle",symbolSize:6,showSymbol:!0,itemStyle:{normal:{color:"#409EFF",borderColor:"#fff",borderWidth:2,lineStyle:{color:"#409EFF",width:3,shadowColor:"rgba(64, 158, 255, 0.3)",shadowBlur:10,shadowOffsetY:5}},emphasis:{symbolSize:8,borderWidth:3}},areaStyle:{normal:{color:new G.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(64, 158, 255, 0.3)"},{offset:.5,color:"rgba(64, 158, 255, 0.1)"},{offset:1,color:"rgba(64, 158, 255, 0.05)"}],!1)}},data:o,animation:!0,animationDuration:1500,animationEasing:"cubicOut"}]}};function B(){const _=[],r=new Date;for(let o=0;o<7;o++){const s=new Date(r);s.setDate(r.getDate()-o);const l=`${s.getMonth()+1}月${s.getDate()}日`;_.push(l)}return _.reverse()}const _t={class:"header-div"},pt={class:"card-content"},ft={class:"card-header"},ht={class:"card-body"},mt={class:"bottom-text count-animation"},vt={class:"card-footer"},gt={class:"card-content"},bt={class:"card-header"},yt={class:"card-body"},xt={class:"bottom-text count-animation"},wt={class:"card-footer"},St={class:"card-content"},Ct={class:"card-header"},Dt={class:"card-body"},kt={class:"bottom-text count-animation"},zt={class:"card-footer"},Lt={class:"common-layout"},Ot={class:"flex-container"},Tt={class:"flex-container"},At={class:"top5-container"},Ft={class:"top5-content"},Nt={class:"top5-header"},Pt={class:"top5-name"},Vt={class:"top5-count"},Bt={class:"top5-progress"},Et=st({__name:"index",setup(_){const r=[{value:"seven",label:"最近7天"},{value:"year",label:"最近一年"}],o=u([]),s=u(B()),l=u([]);(()=>{Z().then(n=>{l.value=(n==null?void 0:n.data)||[]}).catch(()=>{l.value=[]})})();const p=()=>{tt().then(n=>{o.value=(n==null?void 0:n.data)||[]}).catch(()=>{o.value=[]})},m=()=>{et().then(n=>{o.value=(n==null?void 0:n.data)||[]}).catch(()=>{o.value=[]})};p();function f(n){n==="seven"?(s.value=B(),p()):n==="year"&&(s.value=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","12月"],m())}const x=u("seven");it(),dt(),ct();function $(n){if(l.value.length===0)return 0;const g=Math.max(...l.value.map(v=>v.count));return g>0?Math.round(n/g*100):0}function I(n){return["#F56C6C","#E6A23C","#67C23A","#409EFF","#909399"][n]||"#909399"}return(n,g)=>{const v=c("el-text"),z=c("el-tag"),w=c("el-card"),S=c("el-col"),T=c("el-row"),j=c("el-option"),q=c("el-select"),A=c("el-header"),F=c("el-main"),N=c("el-container"),M=c("el-progress");return D(),k("div",null,[a("div",_t,[t(T,{gutter:15},{default:e(()=>[t(S,{span:8},{default:e(()=>[t(w,{class:"stat-card project-card"},{default:e(()=>[a("div",pt,[a("div",ft,[t(i(L),{class:"card-icon project-icon"},{default:e(()=>[t(i(J))]),_:1}),t(v,{class:"top-text"},{default:e(()=>[h("项目总数")]),_:1})]),a("div",ht,[a("span",mt,b(i(O)),1)]),a("div",vt,[t(z,{size:"small",type:"primary"},{default:e(()=>[h("项目")]),_:1})])])]),_:1})]),_:1}),t(S,{span:8},{default:e(()=>[t(w,{class:"stat-card app-card"},{default:e(()=>[a("div",gt,[a("div",bt,[t(i(L),{class:"card-icon app-icon"},{default:e(()=>[t(i(U))]),_:1}),t(v,{class:"top-text"},{default:e(()=>[h("应用总数")]),_:1})]),a("div",yt,[a("span",xt,b(i(E)),1)]),a("div",wt,[t(z,{size:"small",type:"success"},{default:e(()=>[h("应用")]),_:1})])])]),_:1})]),_:1}),t(S,{span:8},{default:e(()=>[t(w,{class:"stat-card vuln-card"},{default:e(()=>[a("div",St,[a("div",Ct,[t(i(L),{class:"card-icon vuln-icon"},{default:e(()=>[t(i(Y))]),_:1}),t(v,{class:"top-text"},{default:e(()=>[h("漏洞总数")]),_:1})]),a("div",Dt,[a("span",kt,b(i(R)),1)]),a("div",zt,[t(z,{size:"small",type:"danger"},{default:e(()=>[h("漏洞")]),_:1})])])]),_:1})]),_:1})]),_:1})]),a("div",Lt,[t(T,{gutter:20},{default:e(()=>[t(S,{span:12},{default:e(()=>[t(w,null,{default:e(()=>[t(N,null,{default:e(()=>[t(A,null,{default:e(()=>[a("div",Ot,[t(v,{tag:"b",size:"large"},{default:e(()=>[h("新增漏洞趋势")]),_:1}),t(q,{modelValue:x.value,"onUpdate:modelValue":g[0]||(g[0]=d=>x.value=d),style:{width:"240px"},onChange:f},{default:e(()=>[(D(),k(P,null,V(r,d=>t(j,{key:d.value,label:d.label,value:d.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])]),_:1}),t(F,{class:"chart-trend"},{default:e(()=>[t(i(W),{class:"chart",option:i(ut)(s.value,o.value),autoresize:""},null,8,["option"])]),_:1})]),_:1})]),_:1})]),_:1}),t(S,{span:12},{default:e(()=>[t(w,null,{default:e(()=>[t(N,null,{default:e(()=>[t(A,null,{default:e(()=>[a("div",Tt,[t(v,{tag:"b",size:"large"},{default:e(()=>[h("漏洞类型TOP5")]),_:1})])]),_:1}),t(F,{class:"chart-trend"},{default:e(()=>[a("div",At,[(D(!0),k(P,null,V(l.value,(d,C)=>(D(),k("div",{key:C,class:"top5-item"},[a("div",{class:nt(["top5-rank",`rank-${C+1}`])},b(C+1),3),a("div",Ft,[a("div",Nt,[a("span",Pt,b(d.vulnerable_type_zh),1),a("span",Vt,b(d.count),1)]),a("div",Bt,[t(M,{percentage:$(d.count),"stroke-width":12,color:I(C),"show-text":!1},null,8,["percentage","color"])])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])])}}});const Jt=H(Et,[["__scopeId","data-v-ca825f7b"]]);export{Jt as default};
